<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <title>Working Form</title>
    <link rel="stylesheet" href="registration-form.css">
</head>
<style>
   
    /* @import url('https://fonts.googleapis.com/css2?family=Roboto+Condensed:ital@1&display=swap'); */
</style>    
<body>
    <div class="container mt-3">
        <!-- create a form -->
        <h2>REGISTRATION FORM</h2>
    
        <form>
            <div class="row">
                <div class="mb-3 mt-3 col-lg-6">
                    <label for="fname"> Enter First Name :</label>
                    <input type="text" oninput="fnameInput()" class="form-control" id="fname" placeholder="Enter First name">
                    <span style="color: red;" id="fnameerr" class="err"></span>
                </div>
                <div class="mb-3 mt-3 col-lg-6">
                    <label for="lname">Enter Last Name :</label>
                    <input type="text" oninput="lnameInput()" class="form-control" id="lname" placeholder="Enter last name">
                    <span style="color: red;" id="lnameerr" class="err"></span>
                </div>
            </div>
            <div class="row">
                <div class="mb-3 mt-3 col-lg-6">
                    <label for="email">Email :</label>
                    <input type="email" oninput="emailInput()" class="form-control" id="email" placeholder="Enter email">
                    <span style="color: red;" id="emailerr" class="err"></span>
                </div>
                <div class="mb-3 mt-3 col-lg-6">
                    <label for="phone">Phone :</label>
                    <input type="tel" oninput="phoneInput()" class="form-control" id="phone" maxlength="10" placeholder="Enter your mobile number">
                    <span style="color: red;" id="numberr" class="err"></span>
                </div>
            </div>
            <div class="row">
                <div class="mb-3 mt-3 col-lg-6">
                    <label for="dob">Date of Birth :</label>
                    <input type="date" oninput="dobInput()" class="form-control" id="dob" placeholder="Enter your birthdate" required>
                </div>
                <div class="mt-3 col-lg-6">
                    <label for="gender">Gender :</label>
                    <div class="gender d-flex mt-3">
                        <div class="form-check d-flex">
                            <input class="form-check-input" type="radio" name="gender" id="male" value="male">
                            <label class="form-check-label" for="male">Male</label>
                        </div>
                        <div class="form-check d-flex">
                            <input class="form-check-input" type="radio" name="gender" id="female" value="female">
                            <label class="form-check-label" for="female">Female</label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mb-3">
                <label for="password">Password :</label>
                <input type="password" oninput="passInput()" class="form-control" id="password" placeholder="Enter password">
                <span style="color: red;" id="passerr" class="err"></span>
            </div>
            <button type="button" onclick="save()" class="btn btn-secondary form-control mt-4">Submit</button>
        </form><br><br>
        <table class="table table-secondary table-striped">
            <tr class="text-center text-capitalize">
                <th>Name</th>
                <th>Email</th>
                <th>contact</th>
                <th>Date of Birth</th>
                <th>Gender</th>
                <!-- <th>Password</th> -->
            </tr>
            <tbody id="record" class="text-center"> </tbody>
        </table>
        <table class="table table-secondary table-striped">
            <div class="year mt-5    text-center">Birth before 2000</div>
            <tr class="text-center text-capitalize">
                <th>Name</th>
                <th>Email</th>
                <th>contact</th>
                <th>Date of Birth</th>
                <th>Gender</th>
                <!-- <th>Password</th> -->
            </tr>
            <tbody id="birthrecord" class="text-center"></tbody>
        </table>
    </div>

    <script type="text/javascript">
        var data = [];
			const fname = document.getElementById('fname');
			const lname = document.getElementById('lname');
            const email = document.getElementById('email');
			const phone = document.getElementById('number');
            const password = document.getElementById('password');
            const fnameerr = document.getElementById('fnameerr');
            const lnameerr = document.getElementById('lnameerr');
            const emailerr = document.getElementById('emailerr');
            const numberr = document.getElementById('numberr');
            const passerr = document.getElementById('passerr');

            function validateFname(fname) // first name requirment
            {
                var fre = /^[a-zA-Z]{4,20}/;
                return fre.test(fname);
            }
            function validateLname(lname) // last name requirment 
            {
                var lre = /^[a-zA-Z]{4,20}/;
                return lre.test(lname);
            }
            function validateEmail(email) // email requirment form
            {
		    	var ere = /\S+@\S+\.\S+/;
		    	return ere.test(email);
		    }
		    function validatePhone(phone) // phone number requirement
            {
		    	var pre = /^\d{10}$/;
		    	return pre.test(phone);
		    }
            function validatepassword(password)//password requirement
            {
                var pwre = /^(?=.[A-Z])(?=.[a-z])(?=.*[^a-zA-Z0-9",;&|']).{8,16}$/;
                return pwre.test(password);
            }

            // fnameInput.addEventListener("input" , function(){
            //     const fname = fnameInput.value;
            //     if(validateFname(fname)){
            //         fnameerr.textContent = "";
            //     } else{
            //         fnameerr.textContent = " Invalid name Format";
            //     }
            // });
            // lnameInput.addEventListener("input" , function(){
            //     const lname = lnameInput.value;
            //     if(validateFname(lname)){
            //         lnameerr.textContent = "";
            //     } else{
            //         lnameerr.textContent = " Invalid name Format";
            //     }
            // });
            // emailInput.addEventListener("input" , function(){
            //     const email = emailInput.value;
            //     if(validateFname(email)){
            //         emailerr.textContent = "";
            //     } else{
            //         emailerr.textContent = " Invalid email Format";
            //     }
            // });
            // passwordInput.addEventListener("input", function () {
            //     const password = passwordInput.value;
            //     if (validatePassword(password)) {
            //       passworderr.textContent = ""; // Clear error message if valid
            //     } else {
            //       passworderr.textContent =
            //         "Password must be 8-15 characters long, have at least one uppercase letter, one lowercase letter, one number, and one special character (excluding \", ;, &, |, ').";
            //     }
            // });
            // phoneInput.addEventListener("input", function () {
            //     const phone = phoneInput.value;
            //     if (validateMobile(phone)) {
            //       phoneerr.textContent = ""; // Clear error message if valid
            //     } else {
            //       phoneerr.textContent = "Invalid phone format";
            //     }
            // });
              


        function fnameInput()
            {
                // var fname = fnameInput.value;
                // if(validateFname(fname)){
                //     fnameerr.textContent = "";
                // } else{
                //     fnameerr.textContent = " Invalid name Format";
                document.getElementById('fnameerr').style.display = "none";
                }
        function lnameInput()
            {
                document.getElementById('lnameerr').style.display = "none";
            }
        function emailInput()
            {
               document.getElementById('emailerr').style.display = "none";
            }
        function passInput()
            {
               document.getElementById('passerr').style.display = "none";
            }
        function phoneInput()
            {
               document.getElementById('numberr').style.display = "none";
            }


        function save(){
            try{
                  let fname = document.getElementById("fname").value;
                  let lname = document.getElementById("lname").value;
                  let email = document.getElementById("email").value;
                  let phone = document.getElementById("phone").value;
                  let gender = document.getElementById("gender").value;
                  let dob = document.getElementById("dob").value;
                  let password = document.getElementById("password").value;
                if(
                    validateFname(fname) && validateLname(lname) && validateEmail(email) && validatepassword(password) && validatePhone(phone))
                {
                    let datestring = dob;
                    let date = datastring.split("-");
                    let year = parseInt(data[0]);
                    let month = parseInt(data[1]);
                    let day = parseInt(data[2]);

                    let user = new Object();
                    user.name = fname.concat(" ",lname);
                    user.email = email;
                    user.phone = phone;
                    user.dateofbirth = date;
                    user.gender = gender;
                    user.password = password;

                if(localStorage.getItem('form') === null || localStorage.getItem('form') === undefined)
                {
                    data.push(user);
                    localStorage.setItem('form' , JSON.stringify(data));
                }
                else
                {
                    let dt = JSON.parse(localStorage.getItem('form'));
                    dt.push(user);
                    localStorage.setItem('form',JSON.stringify(dt));
                }
                alert("record succesfully insert :)");
                document.getElementById('fname').value = "";
                document.getElementById('lname').value = "";
                document.getElementById('email').value = "";
                document.getElementById('phone').value = "";
                document.getElementById('dob').value = "";
                document.getElementById('gender').value = "";
                document.getElementById('password').value = "";

                viewdata();
                }
            }
            catch(err){
                console.log("An Error: ",err);
                }

            function viewdata(){
                    let tbl = "";
                    let savedata = JSON.parse(localStorage.getItem("form"));
                    savedata.map((val) => {
                        tbl += `
                                <tr>
                                    <td>${val.name}</td>
                                    <td>${val.email}</td> 
                                    <td>${val.phone}</td> 
                                    <td>${val.dateofbirth.day}
                                        ${val.dateofbirth.month}
                                        ${val.dateofbirth.year}
                                    </td> 
                                    <td>${val.gender}</td>
                                </tr>
                               `;
                    });
                    document.getElementById("record").innerHTML = tbl;
                }

            function birthrecordData(){
                let tbl = "";
                let savedata = JSON.parse(localStorage.getItem("form"));
                let birthdate = savedata.filter((val) => {
                    return val.dateofbirth.year <=  2000;
                });
                    savedata.map((val) => {
                        tbl += `
                                <tr>
                                    <td>${val.name}</td>
                                    <td>${val.email}</td> 
                                    <td>${val.phone}</td> 
                                    <td>${val.dateofbirth.day}
                                        ${val.dateofbirth.month}
                                        ${val.dateofbirth.year}
                                    </td> 
                                    <td>${val.gender}</td>
                                </tr>
                               `;
                    });
                    document.getElementById("birthrecord").innerHTML = tbl;
                }
            }
    </script>
</body>
</html>